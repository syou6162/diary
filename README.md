# 2014-02-09
## 最近取り上げたい話題
取り上げたいが、書くの面倒とか時間がないなどの話題。忘れないようにメモだけしておく。

- 確定拠出年金
 - これがきっかけで投資(特にインデックス投資)に興味が出てきた
- アーロンチェア
 - 腰が壊滅的にダメになってきたため、ついに購入。引っ越す前後から買う買うといっていたのだが、実際に座れるところがなかなかないので。IDC大塚家具というお店にはるばる行ってきたが、店員さんがアドバイザという形で一人ずつ付いてくれるので大変分かりやすかった。アーロンチェアの後継者であるというエンボディチェアというものを買った。再来週くらいにくる予定

# 2014-01-18
## 新年散財キャンペーン
文具を中心に色々買いました。

### [BB-2 | ブギーボード | KINGJIM](http://www.kingjim.co.jp/sp/boogieboard/bb2.html)
英単語を暗記するときに殴り書きとか、アイディアをなぐり書きとかをするときに重宝。書いてる感覚が紙に書いてるのと近いのがよい。一番大きいサイズを家と会社用に2枚ずつ買ってみました。iPadのメモアプリとかでもいいかなって思ったけど(実際、スタイラスとか数本買ってみた)、書くときに書く人間が気を使ってかかないといけない付近が気に食わなくて使わなかった。Boogie boardだとその辺気にしなくてよい。道具のほうが合わせろよと。

### [薄いメモ帳abrAsus(アブラサス) | 薄くてコンパクトなメモ帳 - abrAsus(アブラサス)ブランド通販サイ](http://superclassic.jp/?pid=37551339)
高いけど、これはいい買い物したと思う。ズボンのポケットにいつでもメモできるようにしておこうとしたことは前もあって、以前は[PocketMod](http://www.pocketmod.com/)とかを使っていたりしたけど、ペンがいいの見つからないとか肝心の紙がグチャグチャになってしまって使うときに萎えるという事態が多発した。薄いメモ帳はペンが常にセットになっているから肝心な時に書けないということがないし、皮のしっかりしたカバーが付いているので紙がぐちゃぐちゃになることがない。どこにでもあるA4を折り曲げるだけなので、気軽にメモできる(いい紙だと、気軽に書くのに心理的ハードルが上がってメモしないという悪循環がある)。A4一枚しか入っていないので、ポケットの中でかさばらない。あと、この折り曲げ方はすごいアイディアだと思う。プレゼントとかにも悪くないものだと思います。小さいポケットみたいなのが付いているので、ICCOCAを入れて使っております。

### [文具王手帳 tecyo@bungu_o 高畑正幸 | 文具王が提案するシンプルなメモ手帳(スケジュール)- abrAsu](http://superclassic.jp/?pid=20962828)
最近のメモは[Day One](http://dayoneapp.com/)に二年くらいとにかく取っているんだけど、思い付いたアイディアを時系列で眺めたいときはやっぱりアナログのほうがよくって紙の手帳に戻ろうかなと考えていた。薄い手帳を買うときに、丁度文具王手帳が目に入ってコンセプトが気に入って買ってみた(という割には高いのだが...)。購入時はリフィルやペンも付いていないのでそっけない感じに見えるのだが、手帳が厚くならないようにとかそれぞれのパーツの配置がよく考えられている。文具王の名に恥じない感じである。

ボールペンは[LAMY 2000 4色ボールペン](http://www.amazon.co.jp/dp/B000UTKMDQ)を入れて使っている。カンガルーホルダには[連想式にみるみる身につく語源で英単語](http://www.amazon.co.jp/dp/4054034217)をA4 2ページくらいを自分でPDFに吐いた[一覧表みたいなの](https://github.com/syou6162/etymology-english)を入れてる。ジョッターですぐにメモできる付近もなかなかすごいアイディアである。

# 2013-11-01
## 今年買ってよかったもの
今年はまだ二月くらいあるけれども...。まとめてみたところ、(前からそうだが)本当に本当に面倒なことが嫌いな人間であるということが分かった。何かができるようになったことより、何かをしなくなってよかったことに対して幸福感を感じる人間である。面倒なことをいかに頑張るかを考えるよりいかに面倒なことをしないでいいかを頑張ったほうがよい。

### Fitbit
[fitbit one](http://www.fitbit.com/one)は誕生日プレゼントでもらったもの、[fitbit aria](http://www.fitbit.com/aria)は自分で買った。

#### Fitbit Oneは「何もしないでいい」ところがよいところ
Fitbit Oneは

- 歩いた歩数
- 距離
- 階段の段数
- 消費カロリー
- アクティブな時間

を計測してくれるのだけれども、ズボンのポケットに付けておくだけでよい。充電も週に一度やれば十分。半年近く使ってて電池が切れたって状態になったことがない。継続させるにはいかに面倒でないか、意識しないでよいかが大事だと個人的に思っているけれども、邪魔にならないし面倒でもない(存在感がないので洗濯してしまわないように注意が必要である)。勝手にログが溜っていく。

父親にも父の日でプレゼントしたのだが、SNSの機能が付いていてFriendsにいる人がこの一週間でどれくらい歩いているかが分かる(一日の詳細レベルでは分からないようになっている)。父に負けるとなんか悔しい気がするので頑張るかという気がしてくるのと、一日頑張るより継続的に頑張るほうが楽であるというのを知ることができるという意味で割とよかった。あと多分実家へは生存確認できるという意味でいいのだと思う(三日くらい歩いてなかったら風邪引いてるのか分かる、みたいな)。

#### Fitbit ariaのいいところも「何もしないでいい」
体重計に乗るだけでwifi経由でアップロードされ、長期間の体重がトラックされるというのは自分ではほとんど何もしなくていいので楽チン。ボタン押すとかアップロードされるまで待たないといけないとかそういう面倒なことがない。

### イヤホン
元々Bluetoothのイヤホンを使っていた。Bluetoothなので、iPhoneからは切り離されたのだが、結局Bluetoothのコントローラーとイヤホンがコードでつながっているのでコードの呪縛からは解き放たれることはない。首にかけるものや後頭部に付けるタイプのものを買って使ってみたことはあるものの、存在感がありすぎて邪魔だったり、耳が痛くなったりしてよろしくなかった。

- [Bose Bluetooth headset Series 2（右耳用） 製品概要 | モバイルヘッドセット | Bose ボーズ](http://www.bose.co.jp/jp_jp?url=/consumer_audio/headphones/mobile_headset/bluetooth_headset2/bluetooth_headset2.jsp)

今度買ったこいつはそもそもコードというものが存在しないし、すごくコンパクトなので付けているのを忘れるときがあるのが心配なくらい。欠点といえば

- イヤホン側だけで音楽の前の曲次の曲に移動できないこと
- (前のBluetoothが8時間くらい持ったこともあり)バッテリの持ちが少し短かく感じられること

だがコードという面倒な存在が消えさったのがとても大きいのでよい買い物だった。片耳ばかりで聞いていると耳が悪くなってしまうのは心配だったから両耳用買ってしまっている。

### デスク
IKEAで買って組立サービスで組み立ててもらった。引っ越した直後に組み立てたので場所があったが、そうじゃないと割と場所がいるので気を付けたほうがいいかもしれない。

- [GALANT デスクコンビネーション 右 - ブラックブラウン - IKEA](http://www.ikea.com/jp/ja/catalog/products/S99903868/)

ディスプレイ2枚並べて作業したいとか論文ちらかしつつ作業したいという欲求があるのだけど、横に長い机だと自分があちこち移動しないといけないので面倒。この机はL字型にできるので椅子のでくるくる回るとディスプレイを見るのと論文を見る、とかっていうのがシームレスにできてよい。また、別々に買ったものをL字型に組合せて使うと接続部分の段差が気になったりするが、このデスクの場合そういうことがなくてストレスなく作業できる(結構重要)。

- [リビングにIKEAで作る2畳の快適仕事環境 – @masuidrive blog](http://blog.masuidrive.jp/2011/08/01/workspace-in-the-living-room/)

確かここを見ていいなと思ったのであった。いいイスも買いたい...。

# 2013-06-12
## core.typedを使ってみました
日本のClojure界隈では使ってみた系のエントリをほとんど見たことがない気がしますが、coreに最近入った[core.typed](https://github.com/clojure/core.typed)を使ってみました。clojure自体の[type hints](http://clojure.org/java_interop#Java%20Interop-Type%20Hints)は高速化には寄与するけど、型レベルの誤りなどを教えてくれるわけではありません。一方、core.typedは「コンパイル時に」型レベルのエラーを検知できます。最近、ネストしたリストなどを扱うことが多く、ネストのレベルを間違ってデータを突っ込んでしまうetcなどで困っていたので導入しよう、と思いました。

とりあえず練習用として、ネストしたvectorと再帰的な構造を例として書いてみました。

- [syou6162/typed-practice](https://github.com/syou6162/typed-practice)

型レベルのエラーを出すことができるのもうれしいんですが、関数の引数の型を知ることができるのもうれしいところです。こんな感じで調べることができる。

```clj
(t/cf first)
(All [x]
     (Fn
      [(t/Option (I (Seqable x) (ExactCount 0))) -> nil]
      [(I (Seqable x) (CountRange 1)) -> x]
      [(t/Option (Seqable x)) -> (t/Option x)]))
```

clojureは例えばlistとかvectorのようなコレクション系の変数には`coll`のような名前を付ける、とか暗黙的な命名規則(?)はあるけれども、型はないので保証まではしてくれない。だけれども、core.typeで型を付けておくと上のように変数の型を知ることができるので、何を投げればいいか実行せずともある程度知ることができます(これまではclojuredocからexampleを動かさないと分からない...ということ多数だった)。単純に型を付けることができるだけでなく、C++の`typedef`のようなこともできるので、意味のある型の情報(例えば`Seqable`が入力で`Seqable`が出力、程度ではなくて`Document`型から`Sentence`型を返すなどの情報が分かる)を得ることができるのも重要なことかな、と思います。

# 2013-05-16
## Jenkinsを導入しました
「testは書いてたんだけど、実行するの忘れいていつの間にかtestが通らなくなっていた...」とか「いつの間にかbuildできなくなっていた...」とかが多発したのでJenkinsを導入してみることにしました。あれこれ設定するのめんどくせぇ、ということでwarファイルを直接動かしている。`~/.jenkins`とかに色々保存されている模様。jenkinsを導入したことで

- いつこけるようになったかを知ることができるようになった
- 通らなくなったのをそもそも早く知ることができるようになった
- これらを無意識(これ重要)のうちにできるようになった

付近がうれしいことです。特にテストの時間がかかるようになったとかはテストを動かすの面倒...ということにつながってくるので、自動化できるとうれしい。自分はGrowl連携とかでやっています。

# 2013-05-05
## Flickrのプロアカウントを取得しました
趣味となって8ヶ月くらいは経過した写真撮影ですが、割と続いています(割と早く飽きるかと思っていた)。そういうわけで、Flickrのプロのアカウントを取得してみました。プロアカウントだと

- 枚数の上限なし(これはproじゃなくてもあるのかも)
- サムネイル画像の生成
- オリジナル画像の保持
- ISOやF値などの情報(Exif)が表示(これはproじゃなくてもあるのかも)

などがあります。写真を撮ってもっと上達したいなぁと思ったらあると助かる機能なので、使っていってもっとうまくなりたい。

# 2013-04-31
## ドラゴンボールZ 神と神を見てきた
ドラゴンボールの映画とか小学生(?)以来って感じですが、気になったので見てきた。

- [ドラゴンボールZ 神と神 2013年３月30日全国超拡大公開！](http://www.dragonball2013.com/)

戦闘シーンとかは結構微妙な感じだったけど、ベジータが映画内でいいキャラになっていたのでよしとするw。

# 2013-04-25
## 「舟を編む」を見てきました
言語処理のアノテーター職人っぽい感じで見ていてよかった。

- [映画『舟を編む』公式サイト | 大ヒット上映中！！](http://fune-amu.com/)

ただし、自分には向いていないように思う...。

# 2013-04-10
## マクロを使って関数定義するときに関数にメタデータを付与する方法
タイトルがすでに複雑。マクロを使って関数を定義しまくるときに、関数にメタデータを付与したい。どういうメタデータを付与するかはマクロの引数によって決まるので決め打ちではない。以下のページを見ていると、`vary-meta`という関数がまさにそれっぽい感じであった。

- [clojure - how to write a macro to add metadata to a function - Stack Overflow](http://stackoverflow.com/questions/11144708/how-to-write-a-macro-to-add-metadata-to-a-function)

これを使うと関数定義時にメタデータをばしばし付与することができる。

```clj
(defmacro def-fn-with-meta [meta-map func-name args & body]
  `(defn ~(apply vary-meta func-name merge meta-map) ~args ~@body))

(def-fn-with-meta {:feature-type "a" :bool true}
  func-a [x] x)

(meta #'func-a) ; {:arglists ([x]), :ns #<Namespace user>, :name func-a, :feature-type "a", :bool true, :line 1, :file "NO_SOURCE_FILE"}
```

これがどんなときに役に立つかというと、適用する関数をある基準で選別したい、例えば上の例なら

- 素性のタイプがあるものだけフィルタリング
- 戻り値がboolのものだけ使う

とか、そんなことを後々したいときに便利に使うことができる。Clojure、マクロと名前空間のあれこれを抑え始めると大分パワーが上がってくる気がする。

### 追記
この用途に関しては`alter-meta!`というそのままな関数が存在したので、それでよさそうです。

```clj
(defn hoge [x] x)
(meta #'hoge) ; {:arglists ([x]), :ns #<Namespace example>, :name hoge, :line 1, :file "NO_SOURCE_FILE"}
(alter-meta! #'hoge assoc :aaa "yeah!!")
(meta #'hoge) ; {:arglists ([x]), :aaa "yeah!!", :ns #<Namespace example>, :name hoge, :line 1, :file "NO_SOURCE_FILE"}
```

# 2013-04-09
## テキストファイルを介さないでread.csvとかをやる
久しぶりにRです。しかし、最近Rを使わなさすぎる。。。ちゃんとした実験っていうより予備予備実験程度のものは出力のファイル名すら考えるのが面倒、さらにそれをplotするためのスクリプトのファイル名を考えるのも面倒ってことがよくあります(怠惰)。そんなときはスクリプトの断片とかをDayOneとか(人によってはevernoteとか?)にペタペタ張っていくんでしょうが、そういうときにデータとコードが分離してしまうのは、それをリンクして考えないといけないコストが発生します。つまり、csvみたいなデータもコード中に含めてしまいたい。しかし、Rの`read.csv`は文字列じゃなくてファイルを第一引数に取る...ということで少し考え込んだんですが、以下のように`textConnection`を間に挟むとファイルっぽく見せてくれるようなので、便利でした。

```r
raw_input <- "Number of documents, F-value
30, 0.418
50, 0.433
100, 0.472
200, 0.493
300, 0.506
342, 0.51"

d <- read.csv(textConnection(raw_input))
plot(d, type="b")
```

# 2013-04-04
## 出力を見つつ、同じ内容をメールで送る
「実験しながら結果は見ておきたい、しかしログにも残しておきたい」というような要望があったときに`tee`コマンドを使えば結果を見つつ、ファイルに出力する、ということができます。しかし、さらにパイプでつなぎたい場合(例えば結果をメールに転送しておきたい)はどうすればいいか?という場合にちょっと分からなくなったのでメモ。結論からいうと`/dev/stderr`に送ってやればよい。

```sh
lein run | tee /dev/stderr | mail syou6162@localhost
```

`/dev/stderr`で結果が表示されつつ、元の標準出力は`mail`のほうに流れてくれる、という仕組み。

# 2013-03-31
## 御所にお花見に行ってきました
本当は自転車であちこち見に行こうと思ったけど、平日で結構疲れていたので、御所だけ見に行くことに。年度末ということもあって死ぬほどの人込みを予想していましたが、御所はそんなに混みまくっているわけではなく、桜自体もいい感じだったのでいいときに行けたようです。

![さくら1](https://gist.github.com/syou6162/5280034/raw/dc1660387e3422606b003e12d39d643863f0ab5d/shrinked-IMGP1852-2.jpg)
![しだれ桜](https://gist.github.com/syou6162/5280034/raw/d3031b29e42ed08999f2356689797ab5ac69d649/shrinked-IMGP1867-2.jpg)
![梅とか桃とか](https://gist.github.com/syou6162/5280034/raw/499e5dd2f134e357627a14abf179c1f9f5796675/shrinked-IMGP1874.jpg)
![さくら2](https://gist.github.com/syou6162/5280034/raw/d9a269b1dae805ea34d196a2054afa1d0c970414/shrinked-IMGP1898.jpg)

望遠レンズが威力を発揮した!
![さくら3](https://gist.github.com/syou6162/5280034/raw/b5ece9f8999882b79b3200a7549317b0364eb34c/shrinked-IMGP1927-2.jpg)
![さくら4](https://gist.github.com/syou6162/5280034/raw/9a7d648e8f609f9162cc6220af48e86c78118966/shrinked-IMGP1928.jpg)

恒例の甘いものとかももちろん。
![いえもん](https://gist.github.com/syou6162/5280034/raw/568a8add366a2af7c75df4498636dfdc4f3aa1c2/shrinked-IMGP2104.jpg)

よい年度末でした!

# 2013-03-21
## finalを乗り越えろ、リフレクション入門
(よく知られた)黒魔術系です。よい子は安易には真似しないほうがよいらしいです。

Clojureはjavaの豊富なライブラリが使えてとてもよろしいのですが、ときどきjava側のライブラリの挙動を変更したくなります。`with-redef`などで一時的に挙動を変えることやjavaのクラスを継承して元のソースを変更することなく、java側のライブラリの挙動を変更するという要望に応えることができます。しかし、java側のクラスに(`protected`ならまだしも)`private`が付いていると継承できなくなってしまうので困ります。

javaはほとんど知らないので初めて知ったのですが、リフレクションというものを使うとそのような`private`が付いたメソッドの継承や`private`のフィールドにアクセス、変更することが可能になるようです。いわゆる黒魔術系?もちろん非推奨の技術だとは思うけど、`private`なメソッドのテストを書きたいときなどに使われるようです(このようなケースでテストを書くべきかについては議論の余地があるっぽいけど、今回は知らないものとして扱う)。

そんなわけでリフレクションを使いたい。javaでリフレクションを使って`private`なメソッドやフィールドにアクセスするためには、まず

```java
import java.lang.reflect.Field;
import java.lang.reflect.Method;
```

をしておきます。

### privateなフィールドにアクセスしたい
例えば`obj`というオブジェクトの`text`というフィールドが`private`で修飾されているけど、アクセスしたいという場合には

```java
Field field = obj.getClass().getDeclaredField("text");
field.setAccessible(true);

System.out.println((String)field.get(obj));
```

などとやるとよいようです。`getClass`メソッドはオブジェクトの属するクラスを返すようなメソッドらしく(?)、継承元のクラスを得たい場合などは`getSuperclass`メソッドをさらにチェーンさせればよいようです(`getClass().getSuperclass().getDeclaredField("text");`など)。`field.get(obj)`の戻り値の方は`Object`型なので、適当にキャストしてあげる必要があるようです。intが欲しい場合などは`field.getInt(obj)`などとする必要があるっぽい。詳しくはjavadoc参照。

### privateなメソッドにアクセスしたい
privateなメソッドにアクセスしたい場合も上記とほぼ同様です。`Field field`とやっていたのを`Method method`、`getDeclaredField`とやっていたのを`getDeclaredMethod`とすれば動きます。呼び出したい場合は`method.invoke(obj, arg1, arg2);`という具合。clojureで
も`invoke`というのをたまに見かけるけど、リフレクションを使っていたのね。

ただし、`private`なメソッドが`static`だった場合、これだけじゃいけないらしくしばらくはまっていました。欲しいメソッドの引数が`String`だった場合

```java
Method method = TargetClass.class.getDeclaredMethod("wantedMethod", String.class);
method.setAccessible(true);
```

という感じで指定して、呼び出す際には

```java
method.invoke(null, "hogehoge");
```

などとやる必要があるらしい。インスタンスが必要ないからこういう感じか。

# 2013-03-09
## 夜の清水寺に行ってきました
[花灯路](http://www.hanatouro.jp)の期間中ということで、高台寺と清水寺に行ってきました。きつねの嫁入りを見れたんですが、写真はうまく取りきれなかった。。。

夜なのになかなかの人込み。お祭りみたい。
![人込み](https://gist.github.com/syou6162/62b0e3544e5e3b16fe9d/raw/94e10745e96832d942d3b70378ab3bc9f57947a4/shrinked-IMGP1603.jpg)

レーザーが出ていてかっちょいい。
![レーザー](https://gist.github.com/syou6162/62b0e3544e5e3b16fe9d/raw/dc9b757bcaf2832d2f43ff11926b0c96feca67d8/shrinked-IMGP1633.jpg)

ライトアップがされていて、デートにもいい感じです。
![ライトアップ](https://gist.github.com/syou6162/62b0e3544e5e3b16fe9d/raw/c2fb01920b34a164e05446fa91606ac54a926f28/shrinked-IMGP1688.jpg)

清水寺でこんだけ人がいないっていうのも珍しい。
![終わり間際](https://gist.github.com/syou6162/62b0e3544e5e3b16fe9d/raw/f0d86cbafe8628c6d17688dbc873f891cc4dc379/shrinked-IMGP1704.jpg)
![階段](https://gist.github.com/syou6162/62b0e3544e5e3b16fe9d/raw/ecbf2462fb4a4675ec4f3614578a92f763e33233/shrinked-IMGP1708.jpg)
![静か](https://gist.github.com/syou6162/62b0e3544e5e3b16fe9d/raw/bca22dd9a12614bd189a5d49d430c7c327790b57/shrinked-IMGP1722.jpg)

これ、最初に水面に映っているのに気がつかなかった。澄みきっている。
![水面1](https://gist.github.com/syou6162/62b0e3544e5e3b16fe9d/raw/7eef627b8b1dea7578e5f95d41204d3b00fe419b/shrinked-IMGP1725.jpg)
![水面2](https://gist.github.com/syou6162/62b0e3544e5e3b16fe9d/raw/43a51bc17a1a5be13df2e2b4a6bae5403b645a46/shrinked-IMGP1736.jpg)

というわけで、夜の清水寺もいつもと雰囲気が違ってなかなか楽しめました。

# 2013-02-10
## pptxのスライド1ページをpdfに変換して、LaTeXで書いたものに挿入
ご無沙汰です。大変忙しく過しております。スライドとか原稿を作りまくるお仕事ばかりでコードが書きたいです。

pptxで図を作っていて、そいつをLaTeXの原稿に挿入したいってことがありました。まず、pptの印刷のところを選択して、現在のページのみを出力します。そして、実際にプリントアウトするのではなく、プレビューでpdfを開くを選択します。そのままでよければpdfとして出力し、余白を削る必要などがあれば選択して、コピー、クリップボードから新規作成をします。

これでpdfはできるのですが、LaTeXから吐いたときに余白ができてしまって困りました。以下のページを参考にするとうまくいきました。

- [へいたといっしょ〜IT業界の辺縁で〜: TeXでPDF画像を利用する（OSX)](http://molekun.blogspot.jp/2008/10/texpdfosx.html)

```tex
\begin{figure*}[htbp]
  \centering
  \includegraphics[mediaboxonly=/CropBox,scale=0.30]{hoge.pdf}
  \caption{I'm 6162!}
  \label{This is label}
\end{figure*}
```

とりあえずこれでうまく行った。Omnigraffleだったらこんなことをしなくても素直にやってくれるのに。。。

# 2013-01-26
## 京都水族館に行ってきました
関西方面にきていたyag_aysと京都水族館に行ってきました。8月に一度きたことがあるので、二度目の来館です。3回以上くることがあるなら年間パスを作っておくとよい感じだったので、作っておけばよかった。。。

京都駅から徒歩でも15分、市バスなら10分もかからずに着くところにあります。海がないのに水族館。
![京都水族館1](https://gist.github.com/syou6162/4971759/raw/64a678c1cc60b932e21bb9a97f25d3e567412710/shrinked-IMGP1280.jpg)
![京都水族館1](https://gist.github.com/syou6162/4971759/raw/54c9d99aecf011b7b94a96b1fd380c407e56a4c9/shrinked-IMGP1283.jpg)

喧嘩してた。
![アザラシ](https://gist.github.com/syou6162/4971759/raw/9613fa3db0acce7085b94731ef131a7e7e34be91/shrinked-IMGP1322.jpg)

癒し系笑顔。
![癒し系](https://gist.github.com/syou6162/4971759/raw/fae53537ff5cfb45cc4cee2b7493191321c8e439/shrinked-IMGP1337.jpg)

生まれて一ヶ月も経ってない赤ちゃんペンギン。ご飯食べてた。かわいい。。。
![赤ちゃんペンギン](https://gist.github.com/syou6162/4971759/raw/b74afb0e0bd612b79a7c3eaaf6e2cf5ba5666fe9/shrinked-IMGP1354.jpg)

顔っぽく見える。
![エイ](https://gist.github.com/syou6162/4971759/raw/5b1cd9a283a81037b70d3b3ac93eb5d793f694a0/shrinked-IMGP1369.jpg)

みんなで一斉にプールに向かっててシャッター切りまくっていた。
![ペンギン1](https://gist.github.com/syou6162/4971759/raw/5b2c6a21046fbf0f5c19a623d6e7a9205aa4acce/shrinked-IMGP1417.jpg)
![ペンギン2](https://gist.github.com/syou6162/4971759/raw/410ca55e25b081b26bcbe67cd8ec72dd34bb10e4/shrinked-IMGP1429.jpg)
![ペンギン3](https://gist.github.com/syou6162/4971759/raw/74e253c559f46a1ade7b4d9a4d837e192d66ca42/shrinked-IMGP1434.jpg)

イルカショー。あんまり前のほうに座ると水食らいます。
![イルカ1](https://gist.github.com/syou6162/4971759/raw/4aa405f599ae62f3ee052fd2f59c798199a5dde7/shrinked-IMGP1451.jpg)
![イルカ2](https://gist.github.com/syou6162/4971759/raw/a043c2bec13a677eca137fedd814970c2c9317c1/shrinked-IMGP1470.jpg)
![イルカ3](https://gist.github.com/syou6162/4971759/raw/34f95a0886ed83850cdce68ed67cc99150627477/shrinked-IMGP1520.jpg)

ちっちゃい子と握手したり。
![握手](https://gist.github.com/syou6162/4971759/raw/301d48df59c415584db50d479a80eb58cb4819a4/shrinked-IMGP1492.jpg)

ヒトデマン。
![ヒトデマン](https://gist.github.com/syou6162/4971759/raw/93ca8948bf379adebed5933629b72daedacd9cab/shrinked-IMGP1557.jpg)

クラゲは壁一面にこんな感じでイルミネーションみたいだった。
![クラゲ](https://gist.github.com/syou6162/4971759/raw/fec9e8b7d7aa9a35dd99d92239443a0f758d75f7/shrinked-IMGP1568.jpg)

また行きましょう。

# 2013-01-23
## LaTeXの原稿で"。、"を"．，"に変換
この日記でもそうだけど、句読点は「。、」で書いている。でも、日本語の論文の原稿とかは「．，」であることが慣例である。IMEの設定とかEmacsの設定で変えてしまえばいいんだけど、変えるのはこの原稿だけでいいって場合がある。Omakeを使ってTeXのファイルをコンパイルしているので、その前処理でそういうのをやってくれればいいなと思ったのでメモ。置換しているだけ。`hoge.tex`ってファイルを編集していて、置換後のが`fuga.tex`になっている。あとはいつも通り。

```ocaml
LATEX = platex
DVIPDFM = dvipdfmx
BIBTEX = jbibtex
DVIPDFMFLAGS = -p a4

LaTeXDocument(fuga, fuga)

fuga.tex: hoge.tex
.DEFAULT: fuga.pdf fuga.dvi

.BUILD_BEGIN:
	nkf hoge.tex | tr "。、" "．，" > fuga.tex
```

# 2013-01-18
## 最近読んだ本
ちょこちょこ読んでます。

- [Amazon.co.jp： 「大発見」の思考法 (文春新書): 山中　伸弥, 益川　敏英: 本](http://www.amazon.co.jp/dp/4166607898/)
- [Amazon.co.jp： 研究者という職業: 林 周二: 本](http://www.amazon.co.jp/dp/4489006853/)
- [Amazon.co.jp： 科学者として生き残る方法: フェデリコ・ロージ, テューダー・ジョンストン, 高橋 さきの: 本](http://www.amazon.co.jp/dp/4822246698/)

プロゲーマーの本は思ったよりすごかった。

- [Amazon.co.jp： 勝ち続ける意志力 (小学館101新書): 梅原 大吾: 本](http://www.amazon.co.jp/dp/4098251329/)
- [Amazon.co.jp： 日本人の足を速くする (新潮新書): 為末 大: 本](http://www.amazon.co.jp/dp/4106102137/)

職場の先輩が貸してくれた本。

- [Amazon.co.jp： 午前零時のサンドリヨン: 相沢 沙呼: 本](http://www.amazon.co.jp/dp/4488024491/)

本じゃないけど、これはよい買い物だった。ダメ人間製造機。

- [Amazon.co.jp： ふんわりぬくぬく、着る毛布！暖か、マイクロファイバー『ぬくふわブランケット』: ホーム&キッチン](http://www.amazon.co.jp/dp/B002XLF1GW/)

# 2013-01-13
## 実験するときに意識してることまとめ
重複または不足多々あるけど、忘備録的な感じで。

### まとめ
- 自分の記憶力を当てにするな
- 再現性を確保しろ

### 前処理、後処理の仕方をログに残しておく
- データの前処理をしたのは一ヶ月前で、粛々と実験してたけど、前処理変更が必要。あれ、この前処理どうやったっけ
- 論文に貼り付ける図、csvファイルから作ってるんだけど、このcsvファイルはどのコマンドをパイプでつないで作ったファイルやねん...

というあるあるなこと。linuxのコマンドをペタっと貼っておくだけなんだからサボらずメモしておく。guiなソフトはこの辺、記録を元に同じのを作るのが不便なのでなるべくcuiで完結していたいところ。

gxpcなどでいくつものマシンにタスクを放り投げる際はコマンドの実行時から実行バイナリを上書きしてしまう可能性がありうる(ついさっきやってしまった…)ので、コンパイル済み or jarで固めたものは日付付きで取っておいて、そいつを指定するようにするとよいかもしれない。

### ログを取る
標準出力とかに出しててもいいんだけど、いくつも並列で走らせてると覚えてるのが面倒。タスクの特徴を表すような名前のファイル(毎回考えるのが面倒ならある程度名前を表しているファイル名の生成規則で自動生成)にログを吐いたりすると後から安心して確認できたり、加工できる。多少多めにログを吐いておいたほうが何かと助かる。ディスク容量はあんまり気にしても仕方ない。ロガーを使いこなそう。容量が気になるのなら、全部終わった後に、目的のディレクトリに移動して`tar zcvf hoge.tar.gz .`などとやれば圧縮もできる。

コマンドライン引数、食わせたファイルなどの情報も必ず吐かせて再現性の確保に努める。

### テストを書く
動作の保証にもなるし、バグったときの足がかりになるし、動的言語だと入出力の型はどういうの食わせればいいか分からなくなるし。100%どうにかできるというものでもないが、確実にコストはペイできる見込みがあるのにどうして書かないのか。

### 処理は小さめにまとめておく
前処理からパラメータ推定、デコード、グラフに出力とかまで全部一個のコマンドで済むのなら覚えておくことが一個だしよさげに見える。しかし、それは一回で済むのならという前提付きだ。そしてその前提は大抵成り立たない。実験は何回もやってうまくいくもんだし、グラフのlegendはよく変えたくなる。一個にまとまってるとどこかでミスをしていたときに全部やり直しになる。小さいのが複数あれば失敗したところからやり直せる。機能は細かく作ってcomposableなようにしておこう。

### 設定可用性を確保する
設定可用性なんて日本語があるのか知らないけど。実験の設定とかで変わりうるもの(食わせるデータ数、パラメータの初期値など)はとりあえず固定しておくのは簡単ではあるけど、あとあと変わってくるもの。`with-redef`とかを使いまくるのはよくないけど、必要な設定はあとでrebindできるようにしておこう。設定するのが面倒ならばディフォルト引数を与えるようにするとか色々やりようはある。コンパイルが必要な言語では設定ファイルは別のリソースディレクトリにあると便利だろう。

MCMC系は乱数のSEEDを意識するのは重要だし、shuffle関数とかもseedを与えれるものを作っておくと便利だろう。

# 2013-01-07
## 年末年始
今年の年末年始はあっちへこっちへ行っていました。濃密で楽しかったです(えっ、これから2月終わりくらいまで忙しいんだからいいじゃないですか...)。

### 東京へ
某イベントで友達と会うために東京へ。それぞれにお土産買ってたらすごい量になっていた。喜んでもらえたようでよかった。

![cuteなやつはしお菓子](https://gist.github.com/raw/cb90c0d39dfc248b0549/3b1fae82ed77fe4961fdd524015f8359816376d0/shrinked-IMG_1524.jpg)
![泊まってたホテル](https://gist.github.com/raw/cb90c0d39dfc248b0549/2f8a1cdd1ac65e343bec3de0e224367ab97d8127/shrinked-IMGP1157.jpg)
![23階はなかなかよい眺めだった](https://gist.github.com/raw/cb90c0d39dfc248b0549/674676ea3ff9893c74e357130559b88639fea8ea/shrinked-IMGP1152.jpg)

### 年越し
年越しは@yag_ays宅で。ガキの使い見てたら年があけてた。

![年越し蕎麦](https://gist.github.com/raw/cb90c0d39dfc248b0549/51945204d41b4ca8909bd5bd0f722909b212c337/shrinked-IMG_1539.jpg)

明けてから浅草寺へ初詣にも行った。

![東京スカイツリー](https://gist.github.com/raw/cb90c0d39dfc248b0549/78ce43a5b8dd89f83d3c4458d08d464927a147ec/shrinked-IMGP1169.jpg)
![雷門](https://gist.github.com/raw/cb90c0d39dfc248b0549/d6b2c180f7b54dc9aef6a26f5db55219249cc6f9/shrinked-IMGP1177.jpg)
![よい天気](https://gist.github.com/raw/cb90c0d39dfc248b0549/76ebbea5fbf1757f2240d5eaff1354f4b80ab437/shrinked-IMGP1183.jpg)
![五重の塔](https://gist.github.com/raw/cb90c0d39dfc248b0549/ae82c2adc920bdb5a5cb3403a7ffa30ea01db699/shrinked-IMGP1190.jpg)
![小舟町](https://gist.github.com/raw/cb90c0d39dfc248b0549/82ea6d0dfd9f79ad15e1c6189e54ebf37b9369cc/shrinked-IMGP1191.jpg)
![大吉だった](https://gist.github.com/raw/cb90c0d39dfc248b0549/cbcc8cdea5c790a251b627f3beb7703d87d1aa84/shrinked-IMGP1204.jpg)
![非常に強力なあんこ](https://gist.github.com/raw/cb90c0d39dfc248b0549/59c11686761caff04ca74b2eda8389ea760f9241/shrinked-IMGP1213.jpg)

### 帰省
7時間くらいかけて新幹線で実家に帰ったけど、さすがに疲れた。実家ではゲームしたり、寝たりしていた。

![刺身](https://gist.github.com/raw/cb90c0d39dfc248b0549/6c72e18010a7dbae47be6164d427d1cdab5aad1c/shrinked-IMGP1216.jpg)
![エビチリうまい](https://gist.github.com/raw/cb90c0d39dfc248b0549/1b282efc31fb7b43e8d81663d6feb017a56cea24/shrinked-IMGP1219.jpg)
![実家にてゆびーと対戦](https://gist.github.com/raw/cb90c0d39dfc248b0549/1bfa946ab996d59bd27f31659b71875b62ee4b00/shrinked-IMG_1545.jpg)
![すーふぁみでぼんばーまん](https://gist.github.com/raw/cb90c0d39dfc248b0549/e026f0a860feed5316133d3a603c2d9154ca4f09/shrinked-IMG_1547.jpg)

### 北野天満宮&下鴨神社

彼女と初詣に行ってきました。あちこち行きまくって楽しかった。

![長くて太いうどん](https://gist.github.com/raw/cb90c0d39dfc248b0549/e9088dd654d0622ff0e4e95d1193c0759633058d/shrinked-IMGP1225.jpg)
![北野天満宮入口](https://gist.github.com/raw/cb90c0d39dfc248b0549/ce2264c556e6074178dbd814f64974c054625ef6/shrinked-IMGP1232.jpg)
![今年は巳年です](https://gist.github.com/raw/cb90c0d39dfc248b0549/2121e94526d17b28d0e24fa658c8b106c32c5f73/shrinked-IMGP1243.jpg)
![下鴨神社](https://gist.github.com/raw/cb90c0d39dfc248b0549/df6b2257bee822c8849d5559f4a6531c0e2fc225/shrinked-IMGP1257.jpg)
![下鴨神社](https://gist.github.com/raw/cb90c0d39dfc248b0549/116e27cd24ff2c781fd80c573543ba5b17af20f2/shrinked-IMGP1266.jpg)
![今出川のカフェ](https://gist.github.com/raw/cb90c0d39dfc248b0549/2d0f8842b925aa63ddd588b6fc27b2ab30d40ddb/shrinked-IMG_1563.jpg)
![下鴨神社付近にて](https://gist.github.com/raw/cb90c0d39dfc248b0549/9d2ebb366ca2f85a6ad7ebc36591e670f7372a5a/shrinked-IMG_1566.jpg)

### まったり

今年もうまいもの食べていきたい。

![お好み焼き](https://gist.github.com/raw/cb90c0d39dfc248b0549/f6495d9c1bf19f0e35fb2329b3fce366e1ac7b59/shrinked-IMG_1549.jpg)
![前菜](https://gist.github.com/raw/cb90c0d39dfc248b0549/bc5cceb42671cd527727a603c944becaae640ad8/shrinked-IMG_1551.jpg)
![ケーキ](https://gist.github.com/raw/cb90c0d39dfc248b0549/0e2c001a509dae4c766bd4dc29206faecb877557/shrinked-IMG_1552.jpg)
![久しぶりのお酒](https://gist.github.com/raw/cb90c0d39dfc248b0549/ef1671641f46c82972f0e2f7c4630f95208044ea/shrinked-IMG_1555.jpg)

# 2012-12-30
## 2012年まとめ
職場では「2012年まとめ記事とか書くとあとで黒歴史化する」とか言われましたが、聞かなかったことにしよう。

### 本業
恐れ多くも企業研究者の一員になってしまいました(ひよっこながらも)。インターンで来てたときからも感じていたけど、本当に自由にやらせてもらえる職場で、周りに優秀な人ばっかりいる職場です。一日に三回くらいは「俺ここにいていいんだろうか?」って思うくらい恵まれた職場です。「俺くる(能力的な意味で)場所間違えたんじゃないんだろうか」とか「もしかして取る人間違えたんじゃね?」とか思いまくりですが、この環境で何もできないんだったら俺はどこでもやっていけないような気がするので、必死にやっています。修士の頃とはテーマが結構変わったので、今やっている分野の基礎事項が分かってなかったりして研究的にはまだ何もできていない状態に近いです。もどかしいです。(人的にも計算機資源などの意味でも)環境が素晴しいだけに、言い訳はできません。成果を残していくしかない、それだけ。

### 研修
始まる前までは、というより始まってからもしばらくは「早く終わって研究したい」とかしか思っていなかった研修ですが、終わってみると自分の中に大きく影響を与えていることが分かります。特に同期の仲間ができた、というのは大きいことです(うちのロケでは同期が自分以外1人しかいないから...)。バックグラウンドや今やってる仕事はもう全然違うけど、販売研修を通して同じ苦労喜びを分かちあった仲間ができたというのは自分にとっての財産となりました。今でもときどき相談とかに乗ってもらっているし、人間的にも尊敬できるやつばっかりなので、今後も仲良くしていきたい。

あと、販売研修という大変つらくもあったものを通して人間力というかコミュニケーション力というかその付近のところに自分の中で大きな変化があったように感じています。NAISTでずっと研究やってたらこれは感じれなかったことだと思う。自分の枠を広げていくうえでこれは大事なものになっていくと思うので、もっとうまく自分の中に取り込んでいきたい。

### プライベート
例年になく充実していました:)。基本的に引き込もりな性格だけど、8月にカメラを買ってからこの日記にも書いているように色んなところに行きました。一緒に行く人がいたから楽しかったってのもありますし、来年もまた色んなところ一緒に行きましょう。よろしく。会社のロケが京都で本当によかった。

あと、小説とかも近年には珍しく読むようになってきていて、これも継続して読んでいきたいな。

# 2012-12-28
## 読了
しばらく通勤読書がおざなりになっていたけど、復活させた。

- [Amazon.co.jp： 英雄の書（上） (新潮文庫): 宮部 みゆき: 本](http://www.amazon.co.jp/dp/410136933X/)

出たばっかりに買ってみた。

- [Amazon.co.jp： HUNTER×HUNTER 31 (ジャンプコミックス): 冨樫 義博: 本](http://www.amazon.co.jp/dp/4088706978/)

あの二人がついに...!不器用な彼等がああなってくれてよかった。

- [Amazon.co.jp： 別冊図書館戦争II (図書館戦争シリーズ 6) (角川文庫): 有川 浩, 徒花 スクモ: 本](http://www.amazon.co.jp/dp/404389810X/)

# 2012-12-15
## Destructuring with clojure
`let`の車輪の再発明。On Lispの勉強中なのです。パターンマッチとかできるようにして、クエリコンパイラとか作りたい([core.match](https://github.com/clojure/core.match)でできるとか言うな、そこ)。

まず、こんなのを

```clj
(destruc '(a (b c) d) 'seq 0)
```

こんな感じで

```clj
((a (clojure.core/nth seq 0))
 ((G__9671 (clojure.core/nth seq 1))
  (b (clojure.core/nth G__9671 0))
  (c (clojure.core/nth G__9671 1)))
 (d (clojure.core/nth seq 2)))
```

変形させる関数を用意。

```clj
(defn atom? [x] (not (seq? x)))

(defn destruc [pattern seq-name n]
  (if (empty? pattern)
    nil
    (let [r (cond (atom? pattern) pattern
                  (= (first pattern) '&) (second pattern)
                  :else nil)]
      (if r
        `((~r (drop ~n ~seq-name)))
        (let [p (first pattern)
              rec (destruc (rest pattern) seq-name (inc n))]
          (if (atom? p)
            (cons `(~p (nth ~seq-name ~n))
                  rec)
            (let [v (gensym)]
              (cons (cons `(~v (nth ~seq-name ~n))
                          (destruc p v 0))
                    rec))))))))
```

次に、上で生成されるようなネストしたリストをネストした`let`に割り当てるような関数を用意。

```clj
(defn dbind-ex [binds body]
  (if (empty? binds)
    `(do ~@body)
    `(let ~(->> binds
                (map (fn [b] (if (seq? (first b)) (first b) b)))
                (apply concat)
                (vec))
       ~(dbind-ex (->> binds
                       (map (fn [b] (if (seq? (first b)) (rest b))))
                       (apply concat)
                       (vec))
                  body))))
```

こんな感じのを

```clj
(dbind-ex (destruc '(a (b c) d) 'seq 0) '((+ x y)))
```

こんな感じに変形できます。

```clj
(clojure.core/let [a (clojure.core/nth seq 0)
                   G__9030 (clojure.core/nth seq 1)
                   d (clojure.core/nth seq 2)]
                  (clojure.core/let [b (clojure.core/nth G__9030 0)
                                     c (clojure.core/nth G__9030 1)]
                                    (do (+ x y))))
```

あとは、これを包んでやるマクロを書くだけ。

```clj
(defmacro dbind [pat s & body]
  (let [gseq (gensym)]
    `(let [~gseq ~s]
       ~(dbind-ex (destruc pat gseq 0) body))))
```

`let`とできること同じだけど、これはこれで面白い。

```clj
(dbind (a b c) '(1 2 3) (list a b c)) ; (1 2 3)
(dbind (a (b c) & d) '(1 (2 3) 4 5) (list a (list b c) d)) ; (1 (2 3) (4 5))
```

今度はパターンマッチをやってみよー。

# 2012-12-08
## 神戸ルミナリエに行ってきました
というわけで行ってきました。久々の神戸。

- [神戸ルミナリエ](http://www.kobe-luminarie.jp/)

京都駅から特急で一時間くらいで着くので意外と近い。研修でお世話になっていた付近のビル周辺にあんなすごいのができるとは思ってもみなかったのでびっくりしました。
![入口付近](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121208/20121208203316_original.jpg?1355826278)
![ガラスに反射してめちゃくちゃ綺麗](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121208/20121208203141_original.jpg?1355826278)
![](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121208/20121208204657_original.jpg?1355826344)
![](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121208/20121208205334_original.jpg?1355826345)
![](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121208/20121208204657_original.jpg?1355826346)
![](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121208/20121208204939_original.jpg?1355826347)
![](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121208/20121208205142_original.jpg?1355826348)
![](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121208/20121208204921_original.jpg?1355826349)

### 番外編
神戸は研修のときにうまいお店を結構知ることができたので、うまいところにもまた行ってきました。

洋食のアサヒ。あそこのビフカツは本当においしい。
![アサヒのビフカツ](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121208/20121208144253_original.jpg?1355826170)

元町駅前の海鮮丼。安いしおいしい。
![海鮮丼](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121209/20121209134235_original.jpg?1355826171)

# 2012-11-18

## 高台寺に行ってきました
### 高台寺
そろそろ京都の紅葉を取りに行かねば...!ってことで[高台寺](http://www.kodaiji.com/index.html)に紅葉を取りに行きました。今週から3週間くらいがどうやら紅葉のピークっぽいけど、人手もピークっぽいので市バスとかは死にそう。

![高台寺入口](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0901.jpg)
![高台寺周辺](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0900.jpg)
![お線香1](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0908.jpg)
![お線香2](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0915.jpg)
![大仏](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0916.jpg)
![大吉](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0917.jpg)
![猛烈に欲しがっている鯉](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0927.jpg)
![紅葉1](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0957.jpg)
![紅葉2](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0959.jpg)
![紅葉3](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0968.jpg)
![紅葉4](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0980.jpg)
![龍1](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP0994.jpg)
![砂がすごい](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP1013.jpg)
![赤がすごい](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP1014.jpg)
![竹林](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP1071.jpg)
![紅葉5](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP1075.jpg)
![うしー](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP1080.jpg)
![京都っぽい通り](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMGP1093.jpg)

### はこぶキッチン
はてなインターンのときのお世話になった[さっこさん](http://twitter.com/sacco0627)がやられているHACOBU KITCHEN@五条に遅めの昼御飯に行ってきました。名前覚えててもらえて嬉しかったw。相変わらずのおいしさだったので、また来たいなーと思います。

![はこぶキッチン入口](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMG_1434.jpg)
![はこぶキッチンカレー](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMG_1436.jpg)
![おからチーズケーキ](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMG_1438.jpg)
![おからクッキー](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMG_1439.jpg)

その後は[京都国際マンガミュージアム](http://www.kyotomm.jp/)に行ってスラムダンクを読み漁ったり、夜はやきうどんを食べて帰ってきました。

![やきうどん](https://raw.github.com/gist/b4f750efd8f5fdac9f83/shrinked-IMG_1442.jpg)

最近へ平日のペースで休日もいると死ぬなって思うことが多いので、休日は意図的に外に出ることを多くしています。学生のときがいかにオンオフの切り替えができていなかったかという。。。

## ソートでshuffle
`sort -r`とかってやるとシャッフルしてくれるので便利なんだけど、Macのsortにはこの機能がないっぽい。そういうわけで`sudo port install coreutils`。

```sh
% echo "hoge\nfuga\npiyo" > tmp.txt
% cat tmp.txt
hoge
fuga
piyo
% cat tmp.txt | gsort -R >! tmp.txt
% cat tmp.txt
hoge
piyo
fuga
```

オンラインアルゴリズムでシャッフルが必要なときに、とか。

# 2012-11-14

## 無名再帰関数をメモ化する
以下の問題点などがあって、タイトルのようなことをやってくれるものが欲しくなった。

- Clojureのmemoizeは再帰関数にはメモ化してくれない
- 再帰関数に名前が付いていれば(普通は付いていると思うが...)、メタデータにくっつけてメモ化することも可能
 - [Amazon.co.jp： The Joy of Clojure: Michael Fogus, Chris Houser: 洋書](http://www.amazon.co.jp/dp/1935182641/)
 - 11.42や12.4などが(とてもとても)参考になった
- しかしながら、上の方法を使っても無名関数だと厳しい...

そもそもなんで無名の再帰関数をメモ化するような事態があるかというと、CYKアルゴリズム(文が与えられたときに、その文を作る確率最大の文脈自由文法はどれか、みたいなのを動的計画法を使って効率的にやる方法)みたいなものをtable使うんじゃなくって再帰っぽく書きたいから。フィボナッチみたいな例だとglobalに一つそういう関数があればよいが、CYKアルゴリズムみたいなものだと文毎にそういう再帰関数が必要(なので無名にしたい)。tableを使ってもいいんだけど、関数型で書いているとどうにも合わないので。。。

---

ここでは簡単のため、フィボナッチ数でやってみる。まともに全展開してしまうとそりゃまぁ時間がかかります。

```clj
(->> (range 35)
     (map (fn fib [n] (if (< n 2) n (+ (fib (- n 2)) (fib (- n 1))))))
     (dorun)
     (time))
; "Elapsed time: 1882.521 msecs"
```

globalにはfibって名前を付けないけど、メモ化するときにはその名前が必要...。というのをあれこれ考えていたら`with-local-vars`というのでそれができそうだった。

```clj
(with-local-vars [fib (memoize
                       (fn [n] (if (< n 2)
                                 n
                                 (+ (fib (- n 2)) (fib (- n 1))))))]
  (time (dorun (map fib (reverse (range 35))))))
; "Elapsed time: 1.132 msecs"
```

無名のvarを作ってくれるそうな(letはvarを作ってくれないことに注意)。CYKみたいなのは相互再帰の形になっているので、単純にこれが適用できるかは分からないけど、足掛かり、ということで。

現在のところ、こんな感じだったら解決できるんじゃないかと考えている。

```clj
(def ^:dynamic fib)
(binding [fib ...] ...)
```

## 本日の衝撃
Clojureでは無名関数に名前が付けれた。これはびびった。

```clj
((fn fib [n] (if (< n 2) n (+ (fib (- n 2)) (fib (- n 1))))) 10) ; 55
```

- [recursion - Non tail-recursive anonymous functions in Clojure - Stack Overflow](http://stackoverflow.com/questions/5626641/non-tail-recursive-anonymous-functions-in-clojure)

# 2012-11-07

## 読了
思っていたよりも、ずっともっとベタベタだった。

- [Amazon.co.jp： 別冊図書館戦争 1―図書館戦争シリーズ(5) (角川文庫 あ): 有川 浩, 徒花 スクモ: 本](http://www.amazon.co.jp/dp/4043898096/)

はー、読んでるこっちが辛くなってきた。

# 2012-11-06

## ひらかたパークに行ってきました
遊園地とか何年(10年?)振りだよって感じでちょっと懐しかった。

![ひらパー](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121106/20121106112626_original.jpg?1352299514)

思ったより小さめの遊園地で、ジェットコースター系のやつ、3回くらい同じの乗ったしていた。調子に乗りすぎたようで、後半は割とクラクラになっていた。三半規管が弱くなっている。。。

# 2012-11-05

## 読了
3-4日かけて一冊を通勤で読むことが最近多かったんだけど、1日で読んでしまった。

- [Amazon.co.jp： 武士道エイティーン (文春文庫): 誉田 哲也: 本](http://www.amazon.co.jp/dp/4167780046/)

やっぱり高校スポーツ、大好きだなー。3年間の思いを1つの試合にかけるっていうあのはかないような、あの独特の空気が好き。

# 2012-11-04

## lein2で無理やりライブラリを再ダウンロードさせる
自分で作ったライブラリのバージョンは上げたくないんだけど、少し変わった、みたいな場合のときに(ディフォルトだと1日に一回しかclojars.orgとかを見に行ってくれない)。

```sh
lein -U deps
```

## ikoma sicp再開します&&図形言語のエッセンス
各位忙しかったり何だかんだで止まっていたsicp勉強会ですが、ozaさんに声をかけてもらったので再開することにしました。

- [sicp/ikoma-sicp](https://github.com/sicp/ikoma-sicp)

Clojureでやる際に図形言語が面倒だったのですが(というかswing)、そこは再開のときは飛ばすことにしました。自分は図形言語を一応やっていたので、そこの付近のエッセンスについて書いておくと、「入力と出力の型を一緒にしておく」ってことがこの付近のエッセンスだったと思います。clojureはhaskellみたいに型を書かなくていいけど、逆に書かないことによりその付近を意識できなくなってしまうので、少々厄介なところ。図形言語で言うと「ペインタをbeloやbesideしたものもまたペインタである」というところを強く意識すると得るものがかなりあります。

上の考え方が役に立った例だとshift-reduce parsingがあります。shift-reduce parsingはstackとqueue(まとめてconfigurationと呼ぶ)に対してleftとかright、shiftやreduceといった操作をしていくのですが、これらの入力も出力もconfigurationになります。このことを考えると、初期のconfigurationからleftとかshiftとかを合成することが可能になってきます。

つまり

```clj
(reduce (shift (left config)))
```

みたいに書いていたものが

```clj
((compose reduce shift left) config)
```

といった風に書けるということです(関数を合成して、まとめて適用している)。できることは同じですが、関数のリストを一気にcomposeして、といったことができるようになってくると色々見通しがよくなってきます。この辺の考え方はhaskellをやると分かりやすくなった気もするし、モナドは下の本でやっと分かるようになってきました。

- [Amazon.co.jp： すごいHaskellたのしく学ぼう!: Miran Lipova a, 田中 英行, 村主 崇行: 本](http://www.amazon.co.jp/dp/4274068854)

# 2012-11-02

## 読了
とてもよかった。続きが気になるから早く読みたいけど、終わって欲しくもない。

- [Amazon.co.jp： 武士道セブンティーン (文春文庫): 誉田 哲也: 本](http://www.amazon.co.jp/dp/4167780038/)

ところで、この本kindleでも読めるようになってる。

# 2012-10-31

## 限度額
今月やたらと研修で東京に呼び出されていたら、帰りの新幹線が限度額越えたということで予約ができない事態が発生。。。しかし、これでしばらく東京へは行かなくていいはず。

## clj-logging-config
できることはそんなに変わらないけど、使いやすさが上がっていてよい。研究だと引数に何指定したときにどういう結果が出たとか、意識しなくても勝手にlogが残っていく、みたいな感じだと理想的かな、と思ったりているので、そんなのを実現するために。

- [malcolmsparks/clj-logging-config](https://github.com/malcolmsparks/clj-logging-config)

# 2012-10-28

## What's Wrong???
係り受け解析とかアライメントとかある程度高次のNLPのタスクを扱っているとエラー分析が割と大変になってくる(CoNLLのフォーマットだけ見てエラー分析はつらい...)。どう改善すればよいかの糸口を得るためにもエラー分析は重要。それをビジュアルにできるツールがあるので紹介。

- [whatswrong - What's Wrong With My NLP? - Google Project Hosting](https://code.google.com/p/whatswrong/)

同時解析とかJoint Inferenceとかの研究で有名な[Sebastian Riedel](http://riedelcastro.github.com/)さんが作ったツール。

- syntactic dependency graphs
- semantic dependency graphs (a la CoNLL 2008)
- Chunks (such as syntactic chunks, NER chunks, SRL chunks etc.)
- Bilingual alignments
- BioNLP events, proteins, locations

などなど、shared-taskをベースにしてやる人にはありがたいツールである。ちなみに、こんな感じの出力が出る。

![bionlp09](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121029/20121029012202.png)
![CoNLL2003](http://cdn-ak.f.st-hatena.com/images/fotolife/s/syou6162/20121029/20121029012203.png)

黒はgoldのデータと予測したものが一致した箇所、青は(予測のほうは外れてて)goldが出したところ、赤は予測のほうが外して出しちゃったやつ、となる。ちなみにdependency parsingの出力をclojureから出すだけならこんな感じで割と簡単にやることができる。

- [syou6162/dorothy-example · GitHub](https://github.com/syou6162/dorothy-example)

# 2012-10-26

## 読了

- [Amazon.co.jp： 図書館革命 図書館戦争シリーズ４ (角川文庫): 有川 浩, 徒花 スクモ: 本](http://www.amazon.co.jp/dp/4043898088/)

はー、ベタベタでよかった。別冊も引き続き読みたい。

# 2012-10-18

## 読了

- [Amazon.co.jp： 図書館危機 図書館戦争シリーズ３ (角川文庫): 有川 浩,徒花 スクモ: 本](http://www.amazon.co.jp/dp/404389807X/)

よいのだけれども、朝からにやけてしまうので通勤の読書に向いているか分からなくなってきたw。

# 2012-10-13

## まどマギ映画
気晴らしに遊びにでも行かんとやってられん、ってことでまどマギの友達と一緒に前後編を一日で見てきました。

- [劇場版 魔法少女まどか☆マギカ](http://www.madoka-magica.com/)

今日から後編が見れるようになったってことで結構混んでいた。。。さやかに妙に感情移入してしまっていた。

# 2012-10-12

## ex-ic
研修の移動で新幹線をよく利用することになりそうなのでex-icを使うようになったのだが、直前でも予約できてなかなか便利。ただ、スマホだと若干使い勝手が悪いなぁ。。。

あと、icocaをsmart icocaに進化させた。

## 読了
笠原いいね。展開的に続きが気になってきた。

- [Amazon.co.jp： 図書館内乱 図書館戦争シリーズ（２） (角川文庫): 有川 浩,徒花 スクモ: 本](http://www.amazon.co.jp/dp/4043898061/)

3巻以降を買った&貸してもらった。

# 2012-10-07

## Clojureで多クラス分類器
[今年の春の開発合宿](https://gist.github.com/57249e4e38ecf6aa37b6)でFOBOSを使ってお手軽単語分割器を書いた(デモは[ここ](http://yasuhisay.info/tiny_word_segmenter)に置いてる)のだけど、そのときには2値分類器を作っていた。そういえば多クラス分類器は作ってなかったなーと思ったので、[これ](https://github.com/syou6162/fobos_clj)をベースにして作った。

- [syou6162/fobos_multiclass_clj](https://github.com/syou6162/fobos_multiclass_clj)

といっても1 vs restでやるだけの簡単なやつです。でも、clojureだけで動くと何かと便利なので。libsvm形式とかに一回用意しないといけないとかは面倒だけど、このライブラリだと

```clj
(def training-example
  [["A" ["hoge" 1] ["fuga" 1]]
   ["B" ["piyo" 1] ["nyan" 1]]
   ["A" ["hoge" 1]]])
```

みたいな形でデータとラベルをつっこめるような感じにした。

# 2012-10-06

## 24を見た
- [24 -TWENTY FOUR- - Hulu](http://www.hulu.jp/24)

毎回気の抜けないストーリー展開だったので、見終わって非常に疲れた。。。色んな正義が交錯。

# 2012-10-05

## Clojureでtemp fileを操作する
`with-open`っぽくやりたいですよね、ってことで。

- [pallet/src/pallet/utils.clj at 7c301919ba585c9a8bfb92d9518f8f7431a1001e · tbatchelli/pallet](https://github.com/tbatchelli/pallet/blob/7c301919ba585c9a8bfb92d9518f8f7431a1001e/src/pallet/utils.clj#L128)

```clj
(require [clojure.java.io :as io])

(defmacro with-temp-file
  [[varname & [content]] & body]
  `(let [~varname (java.io.File/createTempFile "stevedore", ".tmp")]
     (when-let [content# ~content]
       (io/copy content# ~varname))
     (let [rv# (do ~@body)]
       (.delete ~varname)
       rv#)))

;; 使い方
(with-temp-file [file-obj (str (repeat 100000 "content"))]
  (.length file-obj))
```

## leinでlocalのjarを参照する
clojarsとかに入っていなかった場合などなど。ここではJavaのハイパフォーマンスなコレクションのライブラリである[Trove](http://trove.starlight-systems.com/)のjarをleinで追加したい場合を考える。以下のリポジトリを使う。

- [kumarshantanu/lein-localrepo](https://github.com/kumarshantanu/lein-localrepo)

`project.clj`にこんな感じで記述する。

```clj
(defproject seq-dep "0.1.0-SNAPSHOT"
  :description "FIXME: write description"
  :url "http://example.com/FIXME"
  :license {:name "Eclipse Public License"
            :url "http://www.eclipse.org/legal/epl-v10.html"}
  :dependencies [[org.clojure/clojure "1.4.0"]
                 [fobos_clj "0.0.2"]
                 [gnu/trove "1.0"]]
  :plugins [[lein-swank "1.4.4"]
            [lein-localrepo "0.4.1"]]
  :java-source-paths ["src/java/"]
  :main seq-dep.core)
```

これでいい感じにjarを配置してくれる。

```sh
% lein localrepo install src/java/lib/trove.jar gnu/trove 1.0
```

# 2012-10-03

## 読了
- [Amazon.co.jp： 図書館戦争 図書館戦争シリーズ（１） (角川文庫): 有川 浩,徒花 スクモ: 本](http://www.amazon.co.jp/dp/4043898053/)

# 2012-10-01
- 今年度も下期に突入
- 10月はやたらと研修があって、何回も東京に行かないといけない
 - 京阪奈はこういうときに少しあれだ

# 2012-09-30

## hulu
台風がきていて外に出れねーと思っていて気がついたらアカウントを作っていた。

- [Hulu - 人気映画やテレビ番組がお手軽に見放題](http://www.hulu.jp/)

# 2012-09-28

## 生のJavaファイルをClojureから使う
例えば[この辺](https://github.com/aria42/umass-nlp)をclojureから触りたいなーって思ったとしよう。こいつはjarで固められていないので、自分でどうにかしないといけない。そのやり方とかがちょっと分からなくなったのでメモしておく。

まず、project.cljを用意する。`java-source-paths`とかをきちんと書いてやる。

```clj
(defproject hoge "0.1.0-SNAPSHOT"
  :description "FIXME: write description"
  :url "http://example.com/FIXME"
  :license {:name "Eclipse Public License"
            :url "http://www.eclipse.org/legal/epl-v10.html"}
  :dependencies [[org.clojure/clojure "1.4.0"]
                 [log4j/log4j "1.2.16"]
                 [commons-primitives/commons-primitives "1.0"]
                 [org.yaml/snakeyaml "1.5"]
                 [net.htmlparser.jericho/jericho-html "3.1"]]
  :java-source-paths ["edu/"])
```

(cljファイルではなく)javaファイルをコンパイルする。若干警告が出てるけど、気にしない。

```
% lein javac
Compiling 95 source files to /Users/yasuhisa/Desktop/umass-nlp/src/main/java/hoge/target/classes
注:入力ファイルの操作のうち、未チェックまたは安全ではないものがあります。
注:詳細については、-Xlint:unchecked オプションを指定して再コンパイルしてください。
```

このディレクトリで

```
% pwd
/Users/yasuhisa/Desktop/umass-nlp/src/main/java/hoge/target/classes
```

こういう感じのクラスパスを付けてあげれば動く。これでとりあえずjarが提供されていないようなものについても触れるようになったのでちょっと安心である。

```sh
% java -classpath /Users/yasuhisa/.m2/repository/log4j/log4j/1.2.16/log4j-1.2.16.jar:/Users/yasuhisa/.m2/repository/commons-primitives/commons-primitives/1.0/commons-primitives-1.0.jar:. edu.umass.nlp.examples.HMMTest
```

# 2012-09-26

## git rebase関係

つぎはぎになっていた付近をきちんとgitに追加していく簡単ではないお仕事。「あー、あのコミットに追加しそこねた!!」ってやつがあったときに初めてgit rebaseを使った。ここが分かりやすかった。

- [古いコミットを書き換える： 歴史修正主義者のための git rebase -i 入門 - 学習する機械、学習しない人間](http://d.hatena.ne.jp/okmount/20091021/p1#20091021f1)

基本的には書き換えたいコミットの一つ前に戻って`git commit --amend`、終わったら`git rebase --continue`していけばよい。ミスったら`git rebase --abort`で戻れます。

---

rebaseするときにとりあえずstashで退避しておいて、戻したらconflictってことがときどきある。そのときはファイルを選択してcheckout、みたいなことができる。

```sh
git stash list
```

で今あるスタッシュのリストを見て、具体的なファイルの変更点が知りたかったら

```sh
git show stash@{0}:test/PivotGenerativeModel/test/util.clj
```

で見ればよく、戻したかったらこんな感じで戻せる。

```sh
git checkout stash@{0} test/PivotGenerativeModel/test/util.clj
```

- [git-stashしたファイルをapplyしようとしてコンフリクトしたときの解決法 - 豆無日記](http://d.hatena.ne.jp/nobeans/20090525/1243269992)

## 読了

- [Amazon.co.jp： 太陽の塔 (新潮文庫): 森見 登美彦: 本](http://www.amazon.co.jp/dp/4101290512/)

# 2012-09-25

## Linuxで同じファイルを書き換える
例えば`file.txt`っていうファイルがあったときに、行毎にシャッフルしてから同じ`file.txt`にまたそれを書きたい。`nkf --overwrite`みたいなことがしたい。リダイレクトだとそういうことできないのかと思って中間ファイルを作っていたけど、ちゃんとありました。

```sh
% echo hoge fuga piyo > test.txt
% cat test.txt
hoge fuga piyo
% echo xxxxx >! test.txt
% cat test.txt
xxxxx
```

## Gitで日本語ファイル名を扱う
普段ならそんなことしないんだが、会社的な都合でファイルの命名規則が決まっていたりする場合があって、そういうとき用に。以下で設定ができる。

```sh
git config --global core.quotepath false
```

# 2012-09-24

## HandBrakeのCUIで字幕を埋め込む
以前はGUIでポチポチ押していってたんですが、やる量が多くなると面倒なことこの上ないので自動化自動化。

- [DVDをmpegにしておく - Seeking for my unique color.](http://d.hatena.ne.jp/syou6162/20120111/1326210413)

こんなスクリプトを適当に書きました。字幕を埋め込みにしないとiPhoneじゃ見れないのでちょっと苦労した。

- [HandBrakeのCLIでmp4に変換 — Gist](https://gist.github.com/3776204)

## 読了
読み終わった。面白かったので、続きも買おっと。

- [Amazon.co.jp： 武士道シックスティーン (文春文庫): 誉田 哲也: 本](http://www.amazon.co.jp/dp/4167780011/)

最近、朝の通勤時間は読書時間に割り当てられております。

# 2012-09-22

## 関東に遊びに行きました
これまた一ヶ月くらい前の(ry、ですが。夏期休暇を使って東京に行きました。主に人と会っていたのですが、人の写真は勝手に上げれないので必然的に食べものの写真ばかりに。横須賀の刺身がおいしかったです。パンは渋谷の駅に最近できたパン屋さん。

![きゅうり](https://raw.github.com/gist/e18ddb934109a52e34f9/shrinked-IMGP0411.jpg)
![サラダ](https://raw.github.com/gist/e18ddb934109a52e34f9/shrinked-IMGP0412.jpg)
![ハモ](https://raw.github.com/gist/e18ddb934109a52e34f9/shrinked-IMGP0414.jpg)
![](https://raw.github.com/gist/e18ddb934109a52e34f9/shrinked-IMGP0415.jpg)
![刺身](https://raw.github.com/gist/e18ddb934109a52e34f9/shrinked-IMGP0417.jpg)

![](https://raw.github.com/gist/e18ddb934109a52e34f9/shrinked-IMGP0425.jpg)
![](https://raw.github.com/gist/e18ddb934109a52e34f9/shrinked-IMGP0426.jpg)
![](https://raw.github.com/gist/e18ddb934109a52e34f9/shrinked-IMGP0427.jpg)
![](https://raw.github.com/gist/e18ddb934109a52e34f9/shrinked-IMGP0428.jpg)

最後はビール飲んでた。

![](https://raw.github.com/gist/e18ddb934109a52e34f9/shrinked-IMGP0458.jpg)

## 京都、自転車旅
もう一ヶ月前くらいですけど、カメラの練習がてら(最近そればっかりですw)京都市内を自転車で周りました。この本を参考にしてルートを決めました。

- [Amazon.co.jp： 京都自転車デイズ: ワークルーム: 本](http://www.amazon.co.jp/dp/4838104103/)

### 出発

![当日乗って行った自転車](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0296.jpg)
![](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0287.jpg)
![](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0281.jpg)

### 八坂の塔

![八坂の塔](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0298.jpg)
![](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0306.jpg)
![](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0315.jpg)

### 円塔公園

![円塔公園](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0328.jpg)

### 八坂神社

![](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0345.jpg)
![京都っぽい雰囲気の人力車](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0347.jpg)
![](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0352.jpg)
![](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0362.jpg)
![](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0368.jpg)
![](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0373.jpg)

### 御所

![御所](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0387.jpg)

### ご飯系

![昼御飯](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0405.jpg)
![白玉](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0408.jpg)

### 夜景

![月](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0643.jpg)
![京都タワー](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0618.jpg)
![夜景](https://raw.github.com/gist/e5bd13178d9eb586d8fb/shrinked-IMGP0667.jpg)

# 2012-09-21

## コマンドラインユーティリティツール群
調べものしてたら便利そうなの見つけた。

- [brendano/cmdutils](https://github.com/brendano/cmdutils)

Rとかを使っていたら、`mean`とか`sd`とか`summary`とかやりたくなってしまうから

```sh
# alias for stats functions
for f in mean sd max min
do
    alias $f="R --vanilla --slave -e \"x <- scan('stdin', quiet=TRUE); cat($f(x), fill=TRUE)\""
done
```

とかやっていたのだけれど、上のちっちゃいユーティリティツールみたいなののほうが使い勝手よさそう。

JSONで配列のある要素の統計量取りたい、みたいなときとか

```sh
% cat all.json | jsonrb 'puts self.map{|doc| doc.domain}' | summary
N = 26147 		17 unique values
Min   :  0
    25:  4
Median:  7 	Mean: 7.757 	SD: 4.901
    75:  11
Max   :  16
```

のようにできて便利。別に普通にスクリプトを書けばいいんだけど、ワンライナーでできるっていうのがいいところ。他にはこんなのが入ってた。

- approxwc => すんげーでかいファイルの行数とかおおまかに知る
- dateseq => 日付連番を作る
 - `dateseq 2012-09-21 2012-09-30`
- jsonpp => json整形してくれる
- mapagg => 入力の各行に対して何かやって、何かにまとめる。map reduceっぽい何か
- summary => Rの`summary`っぽい表示をしてくれる

# 2012-09-19

## 画像の縮小
markdownは画像のサイズを指定できないっぽいので、カメラで取った写真をそのまま貼るとアホみたいにでかくなる。というわけでその前に縮小したい。いっぱいあるのでコマンドラインで一括処理。

```sh
# convertコマンドはが入っていないなら以下で入れる
sudo port install ImageMagick +lcms +jpeg2
ls IMGP*.jpg | xargs -I@ convert -resize 20% @ shrinked-@
```

# 2012-09-18

## コマンドラインで簡単にお手軽markdownブラウザを作る
markdownのviewer(?)で何を使っているかと聞かれたので。

```sh
cd ~/bin
wget --no-check-certificate https://gist.github.com/raw/152480/41cf559e358fd4dc505af6679d382c3a5bcda3ad/kansit
sudo gem1.9 install kramdown
kansit -s "**/*.md" -c "kramdown < hoge.md  | nkf -w > test.html && open -g test.html"
```

これで自分の好きなエディタを使いながら、リアルタイムpreviewできるからそれでもうよくね?

# 2012-09-17

## 鞍馬と貴船に行ってきました
祝日ということだったので、友達と鞍馬と貴船に遊びに行ってきました。カメラの練習という意味を込めて写真多めでお送りします。

出発の出町柳駅。叡山電鉄には初めて乗りました。

![出町柳駅](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0711.jpg)

京阪奈も静かなところですが、いつもよりさらに静かでした。

![](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0717.jpg)
![](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0727.jpg)

![貴船駅](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0729.jpg)

下を川が流れている。雨天時は中止。

![](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0740.jpg)

![貴船神社入口1](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0743.jpg)
![貴船神社入口2](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0745.jpg)
![貴船神社1](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0746.jpg)
![貴船神社2](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0747.jpg)

水占い。何も書いてないけど...?

![水占いbefore](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0762.jpg)

水に付けると出てきました。大吉!

![大吉](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0764.jpg)

### 突然のそうめん!

人生初めての流しそうめんを体験しました。思ってたよりもどんどんくるので、写真取るの交代しながらじゃないと無理w。

![ひろ文](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0774.jpg)
![そうめん待ち](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0814.jpg)
![そうめんセット](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0827.jpg)
![そうめん1](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0833.jpg)
![そうめん2](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0834.jpg)
![そうめん3](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0835.jpg)
![そうめん4](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0836.jpg)
![そうめん5](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0837.jpg)

### 鞍馬寺

![天狗1](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0840.jpg)
![天狗2](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0841.jpg)

![お寺入口](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0844.jpg)
![](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0851.jpg)
![](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0859.jpg)
![ケーブルカー1](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0864.jpg)
![ケーブルカー2](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0868.jpg)

![のぼっている途中](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0873.jpg)
![本殿](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0878.jpg)
![上からの景色](https://raw.github.com/gist/f22a012421976b2daf5f/shrinked-IMGP0879.jpg)

# 2012-09-16

## compojureでrestartかけずにファイルの反映をさせる
起動になかなか時間がかかるので。。。`[ring-reload-modified "0.1.1"]`をproject.cljに記述して。`[ring.middleware.reload-modified]`をuseした後に

```clj
(def app (wrap-reload-modified #'routes ["src"]))
```

などとやればおk。
